language: node_js
node_js:
  - 16.3.0

cache:
  directories:
    - "$HOME/.npm"

services:
  - docker

branches:
  only:
    - main
    - dev

jobs:
  include:

    # This stage will trigger the build and tests
    - stage: Build
      if: type = push OR type = pull_request
      install:
        - npm i -g yarn
        - yarn install

      script:
        - ./build/docker_build.sh

      after_script:
        - ./build/docker_push.sh
